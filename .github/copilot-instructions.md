# Copilot ä½¿ç”¨è¯´æ˜ï¼šæ‹¼å›¾æ£‹ç›˜æ¸¸æˆé¡¹ç›®

> **ğŸ“– å®Œæ•´æ–‡æ¡£**: æŸ¥çœ‹ `docs/PROJECT_DOCUMENTATION.md` è·å–è¯¦ç»†çš„é¡¹ç›®ä¿¡æ¯

## é¡¹ç›®æ¦‚è¿°

è¯¥é¡¹ç›®åˆ†ä¸º**ä¸¤ä¸ªé˜¶æ®µçš„æ¸¸æˆå¼€å‘**ï¼š

1. **ç®€å•æ‹¼å›¾æ¸¸æˆ**ï¼ˆå·²å®Œæˆ âœ…ï¼‰
   - ä½äº `src/components/PuzzleBoard.vue`
   - 4Ã—4 æ‹–æ‹½æ‹¼å›¾æ¸¸æˆ
   
2. **æ‹¼å›¾æ£‹ç›˜æ¸¸æˆï¼ˆPuzzle Chessï¼‰**ï¼ˆv1.0 å·²å®Œæˆ âœ…ï¼‰
   - 4Ã—4 åŒäººå›åˆåˆ¶ç­–ç•¥æ¸¸æˆ
   - ä¸€å›åˆä¸€åŠ¨ä½œæœºåˆ¶ï¼ˆç§»åŠ¨æˆ–æ—‹è½¬ï¼‰
   - æ ¸å¿ƒç±»å®Œæˆï¼šGameEngine, MoveValidator, Board, PieceManager
   - UI å®Œæˆï¼šChessBoard.vueï¼ˆå¸¦ç§»åŠ¨æç¤ºã€è§„åˆ™é¢æ¿ï¼‰
   - å·²è®¾ä¸ºé¦–é¡µï¼Œå¯ç›´æ¥è®¿é—®

**å½“å‰ç‰ˆæœ¬**: v1.0ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰- 2025-10-17  
**çŠ¶æ€**: MVP å®Œæˆï¼Œå¯ç©æµ‹è¯•ç‰ˆ

---

## ğŸ® æ¸¸æˆè§„åˆ™ï¼ˆv1.0ï¼‰

### æ ¸å¿ƒæœºåˆ¶

- **å›åˆåˆ¶**: ç©å®¶è½®æµè¡ŒåŠ¨
- **ä¸€å›åˆä¸€åŠ¨ä½œ**: æ¯å›åˆåªèƒ½æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œï¼ˆç§»åŠ¨æˆ–æ—‹è½¬ï¼‰
- **è‡ªåŠ¨åˆ‡æ¢**: å®ŒæˆåŠ¨ä½œåè‡ªåŠ¨åˆ‡æ¢åˆ°å¯¹æ–¹å›åˆ

### ç§»åŠ¨è§„åˆ™

- âœ… **æ— è·ç¦»é™åˆ¶**: å¯ç§»åŠ¨åˆ°æ£‹ç›˜ä»»æ„ç©ºä½ç½®
- âœ… **8 ä¸ªæ–¹å‘**: ç›´çº¿ï¼ˆä¸Š/ä¸‹/å·¦/å³ï¼‰+ å¯¹è§’çº¿ï¼ˆ4ä¸ªï¼‰
- âœ… **ä¸å¯é‡å **: ç›®æ ‡æ ¼å­å¿…é¡»ä¸ºç©º
- âœ… **å¿…é¡»ç›´çº¿æˆ–å¯¹è§’çº¿**: ä½¿ç”¨åˆ‡æ¯”é›ªå¤«è·ç¦»è®¡ç®—

### æ—‹è½¬è§„åˆ™

- **ç›¸é‚»ç§»åŠ¨ï¼ˆè·ç¦» = 1ï¼‰**: ç§»åŠ¨åˆ°ç›¸é‚» 8 æ ¼åï¼Œå¯é€‰æ‹©æ˜¯å¦æ—‹è½¬
- **è¿œè·ç¦»ç§»åŠ¨ï¼ˆè·ç¦» > 1ï¼‰**: ä¸èƒ½æ—‹è½¬ï¼Œåªèƒ½ç§»åŠ¨
- **é¸Ÿç±»ç‰¹æƒ**: èµ„æº 4 æ£‹å­å¯åŸåœ°æ—‹è½¬ï¼ˆä¸ç§»åŠ¨ï¼‰
- **æ—‹è½¬è§’åº¦**: 90Â° å¢é‡ï¼ˆ0Â°ã€90Â°ã€180Â°ã€270Â°ï¼‰

### èƒœåˆ©æ¡ä»¶

- **ç©å®¶ 1**: å°†æ‰€æœ‰æ£‹å­ç§»è‡³ç¬¬ 3 è¡Œï¼ˆåº•éƒ¨ï¼‰
- **ç©å®¶ 2**: å°†æ‰€æœ‰æ£‹å­ç§»è‡³ç¬¬ 0 è¡Œï¼ˆé¡¶éƒ¨ï¼‰

---

## æ¶æ„æ ¸å¿ƒ

### OOP è®¾è®¡æ¨¡å¼

é¡¹ç›®ä½¿ç”¨ **é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰** ç®¡ç†æ¸¸æˆçŠ¶æ€ï¼Œ**ä¸ä½¿ç”¨ Pinia**ï¼š

```typescript
// æ¸¸æˆå¼•æ“ - ç®¡ç†æ¸¸æˆçŠ¶æ€
class GameEngine {
  private gameState: GameState
  
  initializeGameState(): GameState
  executeMove(piece, toPosition, rotation?): boolean  // ç§»åŠ¨åè‡ªåŠ¨åˆ‡æ¢å›åˆ
  rotatePiece(piece): boolean  // ä»…é¸Ÿç±»åŸåœ°æ—‹è½¬
  switchTurn(): void
  checkWinCondition(): void
}

// ç§»åŠ¨éªŒè¯å™¨ - éªŒè¯ç§»åŠ¨åˆæ³•æ€§
class MoveValidator {
  static validateMove(piece, toPosition, board, rotation?): MoveValidation
  static getPossibleMoves(piece, board): Move[]
  static calculateChebyshevDistance(from, to): number
}
```

### æ ¸å¿ƒç±»å‹ï¼ˆv1.0ï¼‰

```typescript
// æ¸¸æˆçŠ¶æ€ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
interface GameState {
  currentPlayer: Player          // å½“å‰ç©å®¶ï¼ˆ1 æˆ– 2ï¼‰
  board: BoardCell[][]          // 4Ã—4 æ£‹ç›˜
  player1Pieces: ChessPiece[]   // ç©å®¶ 1 çš„æ£‹å­
  player2Pieces: ChessPiece[]   // ç©å®¶ 2 çš„æ£‹å­
  moveHistory: Move[]           // ç§»åŠ¨å†å²
  winner: Player | null         // è·èƒœè€…
  turnNumber: number            // å›åˆæ•°
  // âŒ å·²ç§»é™¤: actionPoints, maxActionPoints, hasRotatedThisTurn
}

// æ£‹å­
interface ChessPiece {
  id: number
  shapeId: number        // 1-4ï¼ˆå¯¹åº” SVG èµ„æºï¼‰
  player: Player
  position: Position | null
  rotation: Rotation     // 0 | 90 | 180 | 270
  isOnBoard: boolean
  isBird: boolean        // èµ„æº 4 = é¸Ÿç±»ï¼ˆå¯åŸåœ°æ—‹è½¬ï¼‰
}
```

---

## æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ puzzle.ts              # ç®€å•æ‹¼å›¾ç±»å‹ï¼ˆPhase 1ï¼‰
â”‚   â””â”€â”€ chess/                 # æ£‹ç›˜æ¸¸æˆç±»å‹ï¼ˆPhase 2ï¼‰âœ…
â”‚       â””â”€â”€ index.ts
â”œâ”€â”€ classes/
â”‚   â”œâ”€â”€ Puzzle*.ts             # ç®€å•æ‹¼å›¾é€»è¾‘
â”‚   â””â”€â”€ chess/                 # æ£‹ç›˜æ¸¸æˆæ ¸å¿ƒç±» âœ…
â”‚       â”œâ”€â”€ EdgeMatcher.ts     # è¾¹ç¼˜åŒ¹é…ï¼ˆæš‚æœªå¯ç”¨ï¼‰
â”‚       â”œâ”€â”€ MoveValidator.ts   # ç§»åŠ¨éªŒè¯ï¼ˆå·²æ·»åŠ ä¸­æ–‡æ³¨é‡Šï¼‰
â”‚       â”œâ”€â”€ Board.ts           # æ£‹ç›˜ç®¡ç†
â”‚       â”œâ”€â”€ GameEngine.ts      # æ¸¸æˆå¼•æ“ï¼ˆv1.0 ç®€åŒ–ç‰ˆï¼‰
â”‚       â”œâ”€â”€ PieceManager.ts    # æ£‹å­ç®¡ç†
â”‚       â””â”€â”€ __tests__/         # å•å…ƒæµ‹è¯•
â”œâ”€â”€ constants/
â”‚   â””â”€â”€ chess/                 # æ£‹ç›˜é…ç½® âœ…
â”‚       â”œâ”€â”€ pieces.ts          # æ£‹å­å®šä¹‰
â”‚       â””â”€â”€ board.ts           # BOARD_SIZE = 4
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ PuzzleBoard.vue        # ç®€å•æ‹¼å›¾
â”‚   â””â”€â”€ chess/                 # æ£‹ç›˜æ¸¸æˆ UI âœ…
â”‚       â””â”€â”€ ChessBoard.vue     # ä¸»ç»„ä»¶ï¼ˆå«è§„åˆ™é¢æ¿ï¼‰
â”œâ”€â”€ views/
â”‚   â””â”€â”€ ChessView.vue          # æ£‹ç›˜æ¸¸æˆè§†å›¾ï¼ˆé¦–é¡µï¼‰âœ…
â””â”€â”€ router/
    â””â”€â”€ index.ts               # è·¯ç”±é…ç½® âœ…

docs/
â”œâ”€â”€ PROJECT_DOCUMENTATION.md   â­ å®Œæ•´é¡¹ç›®æ–‡æ¡£ï¼ˆæ–°ï¼‰
â”œâ”€â”€ TODO.md                    ğŸ“ å¾…åŠäº‹é¡¹æ¸…å•
â””â”€â”€ DOCUMENTATION_MERGE.md     ğŸ“‹ æ–‡æ¡£åˆå¹¶è¯´æ˜
```

---

## å¼€å‘å·¥ä½œæµ

### è¿è¡Œé¡¹ç›®

```bash
pnpm install      # å®‰è£…ä¾èµ–
pnpm dev          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆé¦–é¡µä¸ºæ£‹ç›˜æ¸¸æˆï¼‰
pnpm build        # ç±»å‹æ£€æŸ¥å¹¶æ„å»º
pnpm test:unit    # è¿è¡Œ Vitest å•å…ƒæµ‹è¯•
```

### ä»£ç è§„èŒƒ

1. **TypeScript ç±»å‹**:
   ```typescript
   // âœ… ä½¿ç”¨ type-only å¯¼å…¥
   import type { ChessPiece, GameState } from '@/types/chess'
   
   // âœ… æ‰€æœ‰å‡½æ•°éƒ½è¦æœ‰ç±»å‹æ³¨è§£
   function executeMove(piece: ChessPiece, to: Position): boolean { }
   
   // âŒ é¿å…ä½¿ç”¨ any
   ```

2. **å‘½åçº¦å®š**:
   - ç±»å: `PascalCase`ï¼ˆå¦‚ `GameEngine`ï¼‰
   - æ–¹æ³•/å˜é‡: `camelCase`ï¼ˆå¦‚ `executeMove`ï¼‰
   - å¸¸é‡: `UPPER_SNAKE_CASE`ï¼ˆå¦‚ `BOARD_SIZE`ï¼‰

3. **æ³¨é‡Š**:
   - ç±»å’Œå…¬å…±æ–¹æ³•ä½¿ç”¨ JSDoc æ³¨é‡Š
   - å…³é”®é€»è¾‘æ·»åŠ ä¸­æ–‡æ³¨é‡Š
   - å¤æ‚ç®—æ³•æ·»åŠ ç¤ºä¾‹

---

## é‡è¦ç‰¹æ€§å’Œé™åˆ¶

### âœ… å½“å‰ç‰ˆæœ¬ç‰¹æ€§ï¼ˆv1.0ï¼‰

1. **ä¸€å›åˆä¸€åŠ¨ä½œ**: ç®€æ´æ˜“æ‡‚çš„å›åˆæœºåˆ¶
2. **æ— è·ç¦»é™åˆ¶**: å¯å¿«é€Ÿç§»åŠ¨åˆ°æ£‹ç›˜ä»»æ„ä½ç½®
3. **æ™ºèƒ½æ—‹è½¬**: ç›¸é‚»ç§»åŠ¨å¯æ—‹è½¬ï¼Œè¿œè·ç¦»ä¸å¯æ—‹è½¬
4. **é¸Ÿç±»ç‰¹æƒ**: èµ„æº 4 æ£‹å­å¯åŸåœ°æ—‹è½¬
5. **ç§»åŠ¨æç¤º**: é€‰ä¸­æ£‹å­åç»¿è‰²åœ†åœˆæ˜¾ç¤ºå¯ç§»åŠ¨ä½ç½®
6. **ç©å®¶æŒ‡ç¤ºå™¨**: é¡¶éƒ¨/åº•éƒ¨æ˜¾ç¤ºå½“å‰å›åˆç©å®¶
7. **å®Œæ•´è§„åˆ™é¢æ¿**: UI å³ä¾§æ˜¾ç¤ºè¯¦ç»†æ¸¸æˆè§„åˆ™

### âŒ å·²ç§»é™¤çš„åŠŸèƒ½

1. **è¡ŒåŠ¨åŠ›ç³»ç»Ÿ**ï¼ˆv0.5 å·²åºŸå¼ƒï¼‰:
   - âŒ æ¯å›åˆ 3 ç‚¹è¡ŒåŠ¨åŠ›
   - âŒ ç§»åŠ¨æ¶ˆè€— 1 ç‚¹è¡ŒåŠ¨åŠ›
   - âŒ æ¯å›åˆé™æ—‹è½¬ 1 æ¬¡

2. **æ£‹å­é‡å **ï¼ˆv0.4 å·²åºŸå¼ƒï¼‰:
   - âŒ å…è®¸æ£‹å­å †å 
   - âŒ åªèƒ½ç§»åŠ¨æœ€é¡¶å±‚æ£‹å­

3. **è·ç¦»é™åˆ¶**ï¼ˆæ—©æœŸç‰ˆæœ¬ï¼‰:
   - âŒ 1-3 æ­¥è·ç¦»é™åˆ¶
   - âœ… ç°åœ¨æ— è·ç¦»é™åˆ¶

### ğŸ”§ æš‚æœªå¯ç”¨çš„åŠŸèƒ½

- **è¾¹ç¼˜åŒ¹é…**: EdgeMatcher ç±»å·²å®ç°ï¼Œä½†å½“å‰ä¸ºè‡ªç”±æ¨¡å¼
  - è¾¹ç¼˜ç±»å‹: `'1+'`, `'1-'`, `'1\`+'`, `'1\`-'`
  - åŒ¹é…è§„åˆ™: `'1+' â†â†’ '1-'`, `'1\`+' â†â†’ '1\`-'`
  - æœªæ¥ç‰ˆæœ¬å¯èƒ½ä½œä¸ºé«˜çº§æ¨¡å¼å¯ç”¨

---

## å…³é”® API

### GameEngine

```typescript
// åˆå§‹åŒ–æ¸¸æˆ
const engine = new GameEngine()
const state = engine.initializeGameState()

// æ‰§è¡Œç§»åŠ¨ï¼ˆç§»åŠ¨åè‡ªåŠ¨åˆ‡æ¢å›åˆï¼‰
const piece = state.player1Pieces[0]
engine.executeMove(piece, { row: 1, col: 0 })

// ç›¸é‚»ç§»åŠ¨æ—¶å¯æ—‹è½¬
engine.executeMove(piece, { row: 1, col: 1 }, 90)

// é¸Ÿç±»åŸåœ°æ—‹è½¬
const birdPiece = state.player1Pieces[3]  // èµ„æº 4
engine.rotatePiece(birdPiece)

// æ‚”æ£‹
engine.undoMove()
```

### MoveValidator

```typescript
// éªŒè¯ç§»åŠ¨
const validation = MoveValidator.validateMove(
  piece,
  { row: 2, col: 2 },
  state.board,
  90  // å¯é€‰æ—‹è½¬è§’åº¦
)

// è·å–æ‰€æœ‰å¯èƒ½çš„ç§»åŠ¨ï¼ˆç”¨äº UI æç¤ºï¼‰
const possibleMoves = MoveValidator.getPossibleMoves(piece, state.board)

// è®¡ç®—åˆ‡æ¯”é›ªå¤«è·ç¦»
const distance = MoveValidator.calculateChebyshevDistance(
  { row: 0, col: 0 },
  { row: 2, col: 1 }
) // è¿”å› 2
```

---

## æ–‡æ¡£å¯¼èˆª

- **å®Œæ•´é¡¹ç›®æ–‡æ¡£**: `docs/PROJECT_DOCUMENTATION.md` â­
  - é¡¹ç›®æ¦‚è¿°ã€æ¸¸æˆè§„åˆ™ã€æŠ€æœ¯æ¶æ„
  - ä»£ç ç»“æ„ã€å¼€å‘æŒ‡å—ã€API æ–‡æ¡£
  - æµ‹è¯•è¯´æ˜ã€ç‰ˆæœ¬å†å²ã€FAQ

- **å¾…åŠäº‹é¡¹**: `docs/TODO.md`
  - å½“å‰è¿›åº¦ã€å·²å®Œæˆä»»åŠ¡
  - ç‰ˆæœ¬æ¼”åŒ–å†å²

- **æ–‡æ¡£åˆå¹¶è¯´æ˜**: `docs/DOCUMENTATION_MERGE.md`
  - æ–‡æ¡£æ•´åˆè¿‡ç¨‹
  - åˆ é™¤çš„è¿‡æ—¶ä¿¡æ¯

---

## è¿›åº¦ç®¡ç†

- **å®æ—¶æ›´æ–°**: ä¿®æ”¹ä»£ç åæ›´æ–° `docs/TODO.md`
- **é—®é¢˜è¿½è¸ª**: é‡åˆ°æ–°é—®é¢˜åˆ›å»ºå¾…åŠäº‹é¡¹
- **ç‰ˆæœ¬æ§åˆ¶**: ç”±ç”¨æˆ·æ‰‹åŠ¨æäº¤ Git
- **æ–‡æ¡£åŒæ­¥**: é‡å¤§å˜æ›´åæ›´æ–° `PROJECT_DOCUMENTATION.md`

---

## è‹¥é‡ä¸æ¸…æ¥šéƒ¨åˆ†

1. **å®Œæ•´æ–‡æ¡£**: æŸ¥é˜… `docs/PROJECT_DOCUMENTATION.md`
2. **API å‚è€ƒ**: æŸ¥çœ‹å®Œæ•´æ–‡æ¡£çš„ "API æ–‡æ¡£" ç« èŠ‚
3. **æ¸¸æˆè§„åˆ™**: æŸ¥çœ‹å®Œæ•´æ–‡æ¡£çš„ "æ¸¸æˆè§„åˆ™" ç« èŠ‚
4. **ä»£ç ç¤ºä¾‹**: æŸ¥çœ‹å®Œæ•´æ–‡æ¡£çš„ "å¼€å‘æŒ‡å—" ç« èŠ‚
5. **FAQ**: æŸ¥çœ‹å®Œæ•´æ–‡æ¡£çš„ "é™„å½• - å¸¸è§é—®é¢˜" ç« èŠ‚

---

**é¡¹ç›®è¯­è¨€**: ä¸­æ–‡ï¼ˆä»£ç æ³¨é‡Šã€æ–‡æ¡£ã€UIï¼‰  
**æŠ€æœ¯æ ˆ**: Vue 3 + TypeScript + Vite  
**è®¾è®¡æ¨¡å¼**: OOPï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰  
**æœ€åæ›´æ–°**: 2025-10-17