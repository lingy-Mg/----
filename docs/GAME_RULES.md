# 拼图棋盘游戏 - 完整规则文档

## 📋 游戏概述

**拼图棋盘游戏（Puzzle Chess）** 是一款双人回合制策略游戏，玩家需要将己方的拼图形状棋子从起始位置移动到对方的起始区域。游戏简洁易懂，但充满策略性。

---

## 🎯 游戏目标

- **棋盘**：4×4 网格（16 个格子）
- **棋子**：每方 4 个拼图形状棋子
- **目标**：将己方所有棋子移至对方的起始行
- **胜利条件**：率先将所有棋子移至对侧的玩家获胜

---

## 🏁 初始设置

### 玩家起始位置

- **玩家 1（蓝色）**：
  - 起始位置：第 0 行（棋盘顶部）
  - 目标位置：第 3 行（棋盘底部）

- **玩家 2（红色）**：
  - 起始位置：第 3 行（棋盘底部）
  - 目标位置：第 0 行（棋盘顶部）

### 棋子类型

每方有 4 个拼图形状棋子（资源 1.svg ~ 资源 4.svg），其中：
- **普通棋子**：资源 1、2、3
- **鸟类棋子**：资源 4（具有特殊能力）

---

## ♟️ 核心规则

### 1. 回合制

- 游戏采用**轮流行动**制
- 每回合玩家只能执行**一个动作**：
  - **移动**棋子到新位置
  - **旋转**棋子（仅鸟类可原地旋转）
- 完成动作后，**自动切换**到对方回合

### 2. 移动规则

#### 移动范围
- 可移动到棋盘上**任意空位置**
- **无距离限制**（可以从棋盘一端移到另一端）
- 目标格子**必须为空**（不可重叠）

#### 移动方向
- 必须沿**直线**或**对角线**移动
- 支持 **8 个方向**：
  - 直线：上、下、左、右
  - 对角线：左上、右上、左下、右下

#### 移动示例
```
✅ 合法移动：
- 从 (0,0) 移动到 (0,3)  // 水平直线
- 从 (0,0) 移动到 (3,0)  // 垂直直线
- 从 (0,0) 移动到 (2,2)  // 对角线

❌ 非法移动：
- 从 (0,0) 移动到 (1,2)  // 不是直线或对角线
- 移动到已有棋子的位置   // 不可重叠
```

### 3. 旋转规则

旋转功能用于调整棋子的朝向，但有严格的使用限制：

#### 相邻移动（距离 = 1 格）
- **允许旋转**：移动到相邻 8 格之一后，可选择是否旋转
- **旋转角度**：90° 增量（0°、90°、180°、270°）
- **效果**：旋转后本次移动结束，切换回合

#### 远距离移动（距离 > 1 格）
- **禁止旋转**：只能移动，无法改变棋子朝向
- **适用场景**：快速占领战略位置

#### 鸟类棋子特权
- **原地旋转**：鸟类棋子可以不移动，直接原地旋转
- **消耗回合**：原地旋转也算一个动作，会结束回合

#### 旋转示例
```
✅ 允许旋转：
- 移动 1 格（相邻格）→ 可旋转
- 鸟类棋子原地不动 → 可旋转

❌ 禁止旋转：
- 移动 2 格及以上 → 无法旋转
- 普通棋子原地 → 无法旋转（必须是鸟类）
```

---

## 🎮 操作指南

### 基本操作

1. **选择棋子**：
   - 点击己方棋子（会显示黄色高亮）
   - 棋盘会显示**绿色圆圈**标记所有可移动位置

2. **移动棋子**：
   - 点击绿色提示的目标格子
   - 棋子自动移动到目标位置

3. **旋转棋子**：
   - **方式 1**：按 `R` 键旋转选中的棋子
   - **方式 2**：点击"旋转"按钮
   - ⚠️ 只有相邻移动或鸟类原地时可旋转

4. **取消选择**：
   - 按 `ESC` 键取消当前选择

5. **跳过回合**：
   - 点击"跳过"按钮提前结束回合

### 快捷键

| 按键 | 功能 |
|------|------|
| `R` | 旋转选中的棋子 |
| `ESC` | 取消选择 |

---

## 🏆 胜利条件

### 基础胜利

- 玩家 1 获胜：所有棋子都在**第 3 行**（底部）
- 玩家 2 获胜：所有棋子都在**第 0 行**（顶部）

### 判定时机

- 每次移动后自动检查胜利条件
- 符合条件的玩家立即获胜，游戏结束

---

## ⚡ 策略要点

### 1. 回合优势
- 每回合只有**一个动作**，需谨慎选择
- 远距离移动效率高，但无法调整朝向
- 相邻移动可旋转，但推进速度慢

### 2. 鸟类棋子
- 鸟类可以**原地旋转**，无需移动
- 适合在关键位置调整朝向
- 灵活性强，可作为战术核心

### 3. 位置卡位
- 利用**不可重叠**规则，占据关键位置
- 阻碍对手前进路径
- 创造己方的推进空间

### 4. 快速推进 vs 精准调整
- **快速推进**：远距离移动，快速抵达目标
- **精准调整**：相邻移动 + 旋转，调整棋子状态

---

## 🚫 重要限制

### 移动限制
- ❌ 不能移动到已有棋子的格子（不可重叠）
- ❌ 必须沿直线或对角线移动（不能走马步）
- ❌ 只能移动己方棋子

### 旋转限制
- ❌ 远距离移动（距离 > 1）时，无法旋转
- ❌ 普通棋子无法原地旋转（只有鸟类可以）
- ❌ 旋转后本回合立即结束，无法再移动

### 回合限制
- ❌ 每回合只能执行一个动作（移动或旋转）
- ❌ 不能连续移动多个棋子
- ❌ 无法撤销已执行的动作（除非使用"悔棋"按钮）

---

## 🎲 游戏模式

### 当前模式：自由模式

- **边缘匹配**：暂不启用
- **移动限制**：仅位置和方向限制，无距离限制
- **重叠规则**：不可重叠

### 未来模式（计划中）

- **边缘匹配模式**：移动后棋子边缘必须匹配
- **威胁机制**：引入攻击和防御规则
- **AI 对手**：单人对战电脑

---

## 📊 游戏状态显示

### UI 元素

- **玩家指示器**：
  - 顶部：玩家 1（蓝色）
  - 底部：玩家 2（红色）
  - 高亮显示当前回合玩家

- **回合计数器**：显示当前回合数

- **可移动提示**：选中棋子后，绿色圆圈标记可移动位置

- **胜利公告**：游戏结束时显示获胜玩家

---

## 💭 新手提示

1. **简洁规则**：一回合一动作，简单易懂
2. **远近平衡**：远距离移动快速，相邻移动灵活
3. **鸟类关键**：善用鸟类的原地旋转能力
4. **战术卡位**：占据关键位置，控制局势
5. **快速推进**：利用无距离限制，快速抵达目标

---

## 🔄 规则版本历史

### v1.0（当前版本）- 2025-01-16

- **核心机制**：一回合一动作（移动或旋转）
- **移动规则**：无距离限制，8 方向移动
- **旋转规则**：相邻移动可旋转，远距离不可旋转
- **鸟类特权**：原地旋转能力
- **不可重叠**：目标格子必须为空

### v0.5（已废弃）- 行动力系统

- ❌ 每回合 3 点行动力（已移除）
- ❌ 移动消耗 1 点行动力（已简化）
- ❌ 每回合限旋转 1 次（已简化）

---

## 📝 术语表

| 术语 | 定义 |
|------|------|
| **回合** | 一个玩家的完整行动周期（一个动作） |
| **动作** | 移动或旋转 |
| **相邻移动** | 移动到周围 8 格之一（距离 = 1） |
| **远距离移动** | 移动距离 > 1 格 |
| **切比雪夫距离** | 包含对角线的距离计算方式 |
| **鸟类棋子** | 可以原地旋转的特殊棋子（资源 4） |
| **起始行** | 玩家开局时棋子所在的行 |
| **目标行** | 玩家需要抵达的对方起始行 |

---

## 📖 相关文档

- **设计文档**：`docs/DESIGN_DOCUMENT.md` - 详细算法和实现细节
- **开发指南**：`docs/QUICK_DEV_GUIDE.md` - 代码示例和开发流程
- **路线图**：`docs/ROADMAP.md` - 功能规划和任务拆解
- **待办事项**：`docs/TODO.md` - 当前进度和待完成任务

---

**祝您游戏愉快！🎮**
